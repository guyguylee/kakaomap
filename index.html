<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8">
  <title>ë¶€ë™ì‚°GPT ì§€ë„ê²€ìƒ‰</title>
  <script src="https://dapi.kakao.com/v2/maps/sdk.js?appkey=8c5fbd54b6d882c2387c4bc6e499c906&libraries=services"></script>
  <style>
    html, body { height:100%; margin:0; padding:0; font-family: sans-serif; }
    #topBar {
      position:absolute; top:10px; left:10px; right:10px;
      display:flex; align-items:flex-start; gap:12px; z-index:10;
    }
    /* ì™¼ìª½ ë©”ë‰´+ìœ„ì¹˜ ìŠ¤íƒ */
    #leftStack {
      display:flex; flex-direction:column; gap:8px;
    }
    .btn {
      width:120px; height:56px;
      background:#fff; border:1px solid #ccc; border-radius:6px;
      font-size:18px; cursor:pointer;
      display:flex; align-items:center; justify-content:center;
      position:relative;
    }
    /* ë“œë¡­ë‹¤ìš´ */
    #dropdown {
      position:absolute; top:56px; left:0;
      width:140px;
      background:#fff; border:1px solid #ccc; border-radius:6px;
      box-shadow:0 2px 6px rgba(0,0,0,0.3);
      display:none; z-index:20;
    }
    .dropdown-item {
      padding:12px 16px; font-size:16px; cursor:pointer;
    }
    .dropdown-item:hover { background:#f0f0f0; }
    /* ê²€ìƒ‰ì°½ */
    #searchBox {
      flex:1; display:flex; align-items:center;
      width:280px; height:56px;
      background:#fff; border:1px solid #ccc; border-radius:6px;
      padding:0 12px; box-shadow:0 1px 3px rgba(0,0,0,0.2);
      position:relative;
    }
    #keyword {
      flex:1; border:none; outline:none;
      font-size:18px; height:32px;
    }
    #searchButton {
      background:none; border:none; font-size:24px; cursor:pointer;
      margin-left:8px;
    }
    /* ê²°ê³¼, ì§€ë„ */
    #resultList {
      position:absolute; top:80px; left:10px; right:10px;
      max-height:240px; overflow-y:auto;
      background:#fff; border-radius:8px;
      box-shadow:0 2px 6px rgba(0,0,0,0.3);
      z-index:9; display:none;
    }
    .item {
      padding:12px; font-size:16px; cursor:pointer;
      border-bottom:1px solid #eee;
    }
    .item:hover { background:#f0f0f0; }
    #map {
      position:absolute; top:0; left:0; right:0; bottom:0;
      z-index:1;
    }
  </style>
</head>
<body>

  <div id="topBar">
    <div id="leftStack">
      <div class="btn" id="menuButton" onclick="toggleDropdown()">ì•„íŒŒíŠ¸</div>
      <div id="dropdown">
        <div class="dropdown-item" onclick="selectMenu('ì•„íŒŒíŠ¸')">ì•„íŒŒíŠ¸</div>
        <div class="dropdown-item" onclick="selectMenu('ë¶„ì–‘ê¶Œ')">ë¶„ì–‘ê¶Œ</div>
        <div class="dropdown-item" onclick="selectMenu('ì›ë£¸')">ì›ë£¸</div>
        <div class="dropdown-item" onclick="selectMenu('íˆ¬ë£¸')">íˆ¬ë£¸</div>
        <div class="dropdown-item" onclick="selectMenu('ê´€ì‹¬')">ê´€ì‹¬</div>
      </div>
      <div class="btn" onclick="moveToCurrentLocation()">ğŸ“ ë‚´ ìœ„ì¹˜</div>
    </div>
    <div id="searchBox">
      <input type="text" id="keyword" placeholder="ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•˜ì„¸ìš”"
             onkeydown="if(event.key==='Enter') searchPlaces();" />
      <button id="searchButton" onclick="searchPlaces()">ğŸ”</button>
    </div>
  </div>

  <div id="resultList"></div>
  <div id="map"></div>

  <script>
    // ì§€ë„ ì´ˆê¸°í™”
    const map = new kakao.maps.Map(
      document.getElementById('map'),
      { center: new kakao.maps.LatLng(37.49334, 127.06672), level: 3 }
    );
    const ps = new kakao.maps.services.Places();
    let markers = [];

    // ë“œë¡­ë‹¤ìš´ í† ê¸€
    function toggleDropdown() {
      const dd = document.getElementById('dropdown');
      dd.style.display = dd.style.display==='block'?'none':'block';
    }
    // ë©”ë‰´ ì„ íƒ
    function selectMenu(name) {
      document.getElementById('menuButton').textContent = name;
      document.getElementById('dropdown').style.display = 'none';
    }

    // ì¥ì†Œ ê²€ìƒ‰
    function searchPlaces() {
      const kw = document.getElementById('keyword').value.trim();
      if (!kw) return alert('ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•˜ì„¸ìš”.');
      ps.keywordSearch(kw, placesSearchCB);
    }
    function placesSearchCB(data, status) {
      if (status === kakao.maps.services.Status.OK) {
        displayPlaces(data);
      } else {
        alert('ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.');
      }
    }
    function displayPlaces(places) {
      const rl = document.getElementById('resultList');
      rl.innerHTML = '';
      clearMarkers();
      places.forEach(p => {
        // ë¦¬ìŠ¤íŠ¸
        const div = document.createElement('div');
        div.className = 'item';
        const gu = p.address_name?.split(' ')[1]||'';
        div.innerHTML = `<div style="display:flex;justify-content:space-between;">
                           <span>${p.place_name}</span>
                           <span style="color:gray;font-size:14px;">${gu}</span>
                         </div>`;
        div.onclick = () => {
          map.setCenter(new kakao.maps.LatLng(p.y,p.x));
          rl.style.display = 'none';
        };
        rl.appendChild(div);
        // ë§ˆì»¤
        const m = new kakao.maps.Marker({
          map, position: new kakao.maps.LatLng(p.y,p.x)
        });
        markers.push(m);
        const iw = new kakao.maps.InfoWindow({
          content: `<div style="padding:5px;font-size:14px;">${p.place_name}</div>`
        });
        kakao.maps.event.addListener(m,'click',()=>iw.open(map,m));
      });
      rl.style.display = 'block';
    }
    function clearMarkers() {
      markers.forEach(m=>m.setMap(null));
      markers = [];
    }

    // ë‚´ ìœ„ì¹˜
    function moveToCurrentLocation() {
      if (!navigator.geolocation) return alert('GPSë¥¼ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.');
      navigator.geolocation.getCurrentPosition(pos=>{
        const loc=new kakao.maps.LatLng(pos.coords.latitude,pos.coords.longitude);
        map.setCenter(loc);
        new kakao.maps.Marker({ map, position:loc });
      }, ()=>alert('ìœ„ì¹˜ ì •ë³´ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.'));
    }
  </script>
</body>
</html>
