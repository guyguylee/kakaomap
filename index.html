<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8">
  <title>ë¶€ë™ì‚°GPT ì§€ë„ê²€ìƒ‰</title>
  <script src="https://dapi.kakao.com/v2/maps/sdk.js?appkey=8c5fbd54b6d882c2387c4bc6e499c906&libraries=services"></script>
  <style>
    html, body { height:100%; margin:0; padding:0; font-family:sans-serif }
    #topBar {
      position:absolute; top:8px; left:8px; right:8px;
      display:flex; align-items:center; gap:8px; z-index:10;
    }
    /* ë©”ë‰´/ë‚´ìœ„ì¹˜ ë²„íŠ¼ */
    .btn {
      width:48px; height:48px;
      background:#fff; border:1px solid #ddd; border-radius:8px;
      display:flex; align-items:center; justify-content:center;
      cursor:pointer;
    }
    /* ë“œë¡­ë‹¤ìš´ */
    #dropdown {
      position:absolute; top:56px; left:0;
      width:140px; background:#fff; border:1px solid #ddd;
      border-radius:8px; box-shadow:0 2px 6px rgba(0,0,0,0.2);
      display:none; z-index:20;
    }
    .dropdown-item {
      padding:12px 16px; font-size:16px; cursor:pointer;
    }
    .dropdown-item:hover { background:#f0f0f0 }
    /* ê²€ìƒ‰ì°½ */
    #searchBox {
      flex:1; display:flex; align-items:center; height:48px;
      background:#fff; border:1px solid #ddd; border-radius:24px;
      padding:0 12px; box-shadow:0 1px 3px rgba(0,0,0,0.1);
    }
    #keyword {
      flex:1; border:none; outline:none; font-size:18px; height:32px;
    }
    #searchButton {
      background:none; border:none; width:32px; height:32px;
      display:flex; align-items:center; justify-content:center;
      cursor:pointer;
    }
    /* ê²°ê³¼ ë¦¬ìŠ¤íŠ¸ */
    #resultList {
      position:absolute; top:64px; left:8px; right:8px;
      background:#fff; border-radius:8px;
      max-height:240px; overflow-y:auto;
      box-shadow:0 2px 6px rgba(0,0,0,0.2);
      display:none; z-index:9;
    }
    .item {
      padding:12px 16px; font-size:16px; cursor:pointer;
      border-bottom:1px solid #eee;
    }
    .item:hover { background:#f9f9f9 }
    /* ì§€ë„ */
    #map {
      position:absolute; top:0; left:0; right:0; bottom:0; z-index:1;
    }
  </style>
</head>
<body>

  <div id="topBar">
    <!-- ì•„íŒŒíŠ¸ ë©”ë‰´ -->
    <div class="btn" id="menuButton" onclick="toggleDropdown()">ğŸ¢</div>
    <div id="dropdown">
      <div class="dropdown-item" onclick="selectMenu('ğŸ¢')">ğŸ¢ ì•„íŒŒíŠ¸</div>
      <div class="dropdown-item" onclick="selectMenu('ğŸ”‘')">ğŸ”‘ ë¶„ì–‘ê¶Œ</div>
      <div class="dropdown-item" onclick="selectMenu('ğŸ›ï¸')">ğŸ›ï¸ ì›ë£¸</div>
      <div class="dropdown-item" onclick="selectMenu('ğŸ ')">ğŸ  íˆ¬ë£¸</div>
      <div class="dropdown-item" onclick="selectMenu('â­')">â­ ê´€ì‹¬</div>
    </div>

    <!-- ë‚´ìœ„ì¹˜ ì•„ì´ì½˜ë§Œ -->
    <div class="btn" onclick="moveToCurrentLocation()">ğŸ“</div>

    <!-- ê²€ìƒ‰ì°½: ì…ë ¥ + ì•„ì´ì½˜ -->
    <div id="searchBox">
      <input type="text" id="keyword" placeholder="ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•˜ì„¸ìš”"
             onkeydown="if(event.key==='Enter') searchPlaces();" />
      <button id="searchButton" onclick="searchPlaces()">
        <!-- ë‹¤ë°©/ì¹´ì¹´ì˜¤ì™€ ë™ì¼í•œ SVG ì§ì ‘ ì‚½ì… -->
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="#555" viewBox="0 0 24 24">
          <path d="M9.5 3a6.5 6.5 0 014.897 10.672l4.966 4.966-1.415 1.414-4.966-4.965A6.5 6.5 0 119.5 3zm0 2a4.5 4.5 0 100 9 4.5 4.5 0 000-9z"/>
        </svg>
      </button>
    </div>
  </div>

  <div id="resultList"></div>
  <div id="map"></div>

  <script>
    // Kakao Map
    const map = new kakao.maps.Map(
      document.getElementById('map'),
      { center: new kakao.maps.LatLng(37.49334,127.06672), level:3 }
    );
    const ps = new kakao.maps.services.Places();
    let markers=[];

    function toggleDropdown(){
      const dd=document.getElementById('dropdown');
      dd.style.display = dd.style.display==='block'? 'none':'block';
    }
    function selectMenu(icon){
      document.getElementById('menuButton').textContent = icon;
      document.getElementById('dropdown').style.display='none';
    }

    function searchPlaces(){
      const kw=document.getElementById('keyword').value.trim();
      if(!kw)return alert('ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•˜ì„¸ìš”.');
      ps.keywordSearch(kw, placesSearchCB);
    }
    function placesSearchCB(data,status){
      if(status===kakao.maps.services.Status.OK){
        displayPlaces(data);
      }else{
        alert('ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.');
      }
    }
    function displayPlaces(places){
      const rl=document.getElementById('resultList');
      rl.innerHTML=''; clearMarkers();
      places.forEach(p=>{
        // ë¦¬ìŠ¤íŠ¸ ì•„ì´í…œ
        const div=document.createElement('div');
        div.className='item';
        const gu=p.address_name?.split(' ')[1]||'';
        div.innerHTML=`<div style="display:flex;justify-content:space-between">
                          <span>${p.place_name}</span>
                          <span style="font-size:14px;color:gray">${gu}</span>
                       </div>`;
        div.onclick=()=>{
          map.setCenter(new kakao.maps.LatLng(p.y,p.x));
          rl.style.display='none';
        };
        rl.appendChild(div);
        // ë§ˆì»¤
        const m=new kakao.maps.Marker({
          map, position: new kakao.maps.LatLng(p.y,p.x)
        });
        markers.push(m);
        const iw=new kakao.maps.InfoWindow({
          content:`<div style="padding:5px;font-size:14px">${p.place_name}</div>`
        });
        kakao.maps.event.addListener(m,'click',()=>iw.open(map,m));
      });
      rl.style.display='block';
    }
    function clearMarkers(){ markers.forEach(m=>m.setMap(null)); markers=[]; }

    function moveToCurrentLocation(){
      if(!navigator.geolocation)return alert('GPS ì§€ì› ì•ˆí•¨');
      navigator.geolocation.getCurrentPosition(
        pos=>{
          const loc=new kakao.maps.LatLng(pos.coords.latitude,pos.coords.longitude);
          map.setCenter(loc);
          new kakao.maps.Marker({ map, position:loc });
        },
        ()=>alert('ìœ„ì¹˜ ì •ë³´ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.')
      );
    }
  </script>
</body>
</html>
