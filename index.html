<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>ë¶€ë™ì‚°GPT ì§€ë„</title>
  <script type="text/javascript" src="https://dapi.kakao.com/v2/maps/sdk.js?appkey=bfd55780f8253cce45449ed9df7b7c7a&libraries=services"></script>
  <style>
    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
    }
    #searchBox {
      position: absolute;
      top: 10px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 2;
      background: white;
      padding: 8px;
      border-radius: 8px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.3);
      display: flex;
      gap: 5px;
    }
    #map {
      width: 100%;
      height: 100%;
    }
  </style>
</head>
<body>

  <!-- ì£¼ì†Œ ê²€ìƒ‰ì°½ + í˜„ì¬ìœ„ì¹˜ ë²„íŠ¼ -->
  <div id="searchBox">
    <input type="text" id="address" placeholder="ì£¼ì†Œë¥¼ ì…ë ¥í•˜ì„¸ìš”" style="width: 200px; height: 30px;">
    <button onclick="searchAddress()">ê²€ìƒ‰</button>
    <button onclick="moveToCurrentLocation()">í˜„ì¬ìœ„ì¹˜</button>
  </div>

  <!-- ì§€ë„ ì˜ì—­ -->
  <div id="map"></div>

  <script>
    var container = document.getElementById('map');
    var options = {
      center: new kakao.maps.LatLng(37.49334, 127.06672), // ì€ë§ˆì•„íŒŒíŠ¸
      level: 3
    };
    var map = new kakao.maps.Map(container, options);

    var geocoder = new kakao.maps.services.Geocoder();
    var currentMarker = null; // í˜„ì¬ ë§ˆì»¤ ì €ì¥ìš©

    function searchAddress() {
      var address = document.getElementById('address').value;
      geocoder.addressSearch(address, function(result, status) {
        if (status === kakao.maps.services.Status.OK) {
          var coords = new kakao.maps.LatLng(result[0].y, result[0].x);
          map.setCenter(coords);

          // ì´ì „ ë§ˆì»¤ ì œê±°
          if (currentMarker) {
            currentMarker.setMap(null);
          }

          // ğŸ”¥ ìƒˆë¡œìš´ ë§ˆì»¤ ìƒì„±
          currentMarker = new kakao.maps.Marker({
            map: map,
            position: coords
          });

          // ğŸ”µ ë§ˆì»¤ í´ë¦­ì‹œ InfoWindow ì—´ê¸°
          var infowindow = new kakao.maps.InfoWindow({
            content: '<div style="padding:5px;font-size:14px;">' + address + '</div>'
          });

          kakao.maps.event.addListener(currentMarker, 'click', function() {
            infowindow.open(map, currentMarker);
          });
        }
      });
    }

    // ğŸŸ¢ í˜„ì¬ ìœ„ì¹˜ ì´ë™ í•¨ìˆ˜
    function moveToCurrentLocation() {
      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(function(position) {
          var lat = position.coords.latitude;
          var lon = position.coords.longitude;
          var locPosition = new kakao.maps.LatLng(lat, lon);

          map.setCenter(locPosition);

          // ì´ì „ ë§ˆì»¤ ì œê±°
          if (currentMarker) {
            currentMarker.setMap(null);
          }

          // ğŸ”¥ í˜„ì¬ ìœ„ì¹˜ì— ë§ˆì»¤ ìƒì„±
          currentMarker = new kakao.maps.Marker({
            map: map,
            position: locPosition
          });

          var infowindow = new kakao.maps.InfoWindow({
            content: '<div style="padding:5px;font-size:14px;">í˜„ì¬ ìœ„ì¹˜</div>'
          });

          kakao.maps.event.addListener(currentMarker, 'click', function() {
            infowindow.open(map, currentMarker);
          });
        });
      } else {
        alert('GPSë¥¼ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤');
      }
    }
  </script>

</body>
</html>
