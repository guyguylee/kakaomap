<!DOCTYPE html>
<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8">
  <title>Î∂ÄÎèôÏÇ∞GPT ÏßÄÎèÑÍ≤ÄÏÉâ</title>
  <script type="text/javascript" src="https://dapi.kakao.com/v2/maps/sdk.js?appkey=8c5fbd54b6d882c2387c4bc6e499c906&libraries=services"></script>
  <style>
    html, body { height: 100%; margin: 0; padding: 0; font-size: 16px; }
    #topBar { position: absolute; top: 10px; left: 10px; right: 10px; display: flex; align-items: center; gap: 8px; z-index: 10; }
    .top-btn { height: 48px; background: white; border: 1px solid #ccc; border-radius: 6px; padding: 0 16px; font-size: 16px; cursor: pointer; display: flex; align-items: center; }
    #dropdown { display: none; position: absolute; top: 48px; left: 0; background: white; border: 1px solid #ccc; border-radius: 6px; box-shadow: 0 2px 6px rgba(0,0,0,0.3); z-index: 20; width: 140px; }
    .dropdown-item { padding: 12px 16px; font-size: 16px; cursor: pointer; }
    .dropdown-item:hover { background-color: #f0f0f0; }
    #searchBox { flex: 1; display: flex; align-items: center; background: white; border: 1px solid #ccc; border-radius: 6px; height: 48px; padding: 0 8px; box-shadow: 0 1px 3px rgba(0,0,0,0.2); position: relative; }
    #keyword { flex: 1; height: 32px; border: none; outline: none; font-size: 16px; }
    #searchButton { background: none; border: none; font-size: 20px; cursor: pointer; margin-left: 8px; }
    #recentList { position: absolute; top: 48px; left: 0; right: 0; background: white; border: 1px solid #ccc; border-radius: 6px; box-shadow: 0 2px 5px rgba(0,0,0,0.2); display: none; z-index: 15; max-height: 240px; overflow-y: auto; }
    .recent-item { display: flex; justify-content: space-between; align-items: center; padding: 12px 16px; font-size: 16px; }
    .recent-item:hover { background-color: #f0f0f0; }
    .delete-btn { background: none; border: none; font-size: 16px; color: #888; cursor: pointer; }
    #resultList { position: absolute; top: 68px; left: 10px; right: 10px; background: white; border-radius: 8px; box-shadow: 0 2px 6px rgba(0,0,0,0.3); max-height: 200px; overflow-y: auto; z-index: 9; }
    .item { padding: 8px; cursor: pointer; border-bottom: 1px solid #eee; font-size: 16px; }
    .item:hover { background-color: #f0f0f0; }
    #map { position: absolute; top: 0; left: 0; right: 0; bottom: 0; width: 100%; height: 100%; z-index: 1; }
  </style>
</head>
<body>
<div id="topBar">
  <div class="top-btn" onclick="toggleDropdown()" id="menuButton">ÏïÑÌååÌä∏<div id="dropdown">
      <div class="dropdown-item" onclick="selectMenu('ÏïÑÌååÌä∏')">ÏïÑÌååÌä∏</div>
      <div class="dropdown-item" onclick="selectMenu('Î∂ÑÏñëÍ∂å')">Î∂ÑÏñëÍ∂å</div>
      <div class="dropdown-item" onclick="selectMenu('ÏõêÎ£∏')">ÏõêÎ£∏</div>
      <div class="dropdown-item" onclick="selectMenu('Ìà¨Î£∏')">Ìà¨Î£∏</div>
      <div class="dropdown-item" onclick="selectMenu('Í¥ÄÏã¨')">Í¥ÄÏã¨</div>
    </div>
  </div>
  <button class="top-btn" onclick="moveToCurrentLocation()">ÎÇ¥ ÏúÑÏπò</button>
  <div id="searchBox">
    <input type="text" id="keyword" placeholder="Í≤ÄÏÉâÏñ¥Î•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî" onfocus="showRecent()" onblur="hideRecent()" onkeydown="if(event.key==='Enter') searchPlaces();">
    <button id="searchButton" onclick="searchPlaces()">üîç</button>
    <div id="recentList"></div>
  </div>
</div>
<div id="resultList"></div>
<div id="map"></div>
<script>
var map = new kakao.maps.Map(document.getElementById('map'), { center: new kakao.maps.LatLng(37.49334,127.06672), level:3 });
var ps = new kakao.maps.services.Places(), markers=[];
function toggleDropdown(){let d=document.getElementById('dropdown');d.style.display=d.style.display==='block'?'none':'block';}
function selectMenu(name){document.getElementById('menuButton').childNodes[0].textContent=name;toggleDropdown();}
function searchPlaces(){let kw=document.getElementById('keyword').value.trim();if(!kw){alert('Í≤ÄÏÉâÏñ¥Î•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî.');return;}saveRecent(kw);ps.keywordSearch(kw,placesSearchCB);hideRecent();}
function placesSearchCB(data,status){if(status===kakao.maps.services.Status.OK){displayPlaces(data);} else alert('Í≤ÄÏÉâ Í≤∞Í≥ºÍ∞Ä ÏóÜÏäµÎãàÎã§.');}
function displayPlaces(places){let rl=document.getElementById('resultList');rl.innerHTML='';clearMarkers();places.forEach(p=>{addListItem(p);addMarker(p);});rl.style.display='block';}
function addListItem(p){let rl=document.getElementById('resultList'),it=document.createElement('div');it.className='item';let gu=p.address_name?'<span style="font-size:14px;color:gray;">'+p.address_name.split(' ')[1]+'</span>':'';it.innerHTML=`<div style="display:flex;justify-content:space-between;"><span>${p.place_name}</span>${gu}</div>`;it.onclick=()=>{map.setCenter(new kakao.maps.LatLng(p.y,p.x));document.getElementById('keyword').value='';rl.style.display='none';};rl.appendChild(it);}
function addMarker(p){let m=new kakao.maps.Marker({map:map,position:new kakao.maps.LatLng(p.y,p.x)});markers.push(m);let iw=new kakao.maps.InfoWindow({content:'<div style="padding:5px;font-size:14px;">'+p.place_name+'</div>'});kakao.maps.event.addListener(m,'click',()=>iw.open(map,m));}
function clearMarkers(){markers.forEach(m=>m.setMap(null));markers=[];}
function moveToCurrentLocation(){navigator.geolocation?navigator.geolocation.getCurrentPosition(pos=>{let loc=new kakao.maps.LatLng(pos.coords.latitude,pos.coords.longitude);map.setCenter(loc);new kakao.maps.Marker({map:map,position:loc});},()=>alert('ÏúÑÏπò Ï†ïÎ≥¥Î•º Í∞ÄÏ†∏Ïò¨ Ïàò ÏóÜÏäµÎãàÎã§.')):alert('GPS ÏßÄÏõê ÏïàÌï®');}
function saveRecent(k){let r=JSON.parse(localStorage.getItem('recents')||'[]');r=r.filter(x=>x!==k);r.unshift(k);if(r.length>5)r.pop();localStorage.setItem('recents',JSON.stringify(r));}
function showRecent(){let r=JSON.parse(localStorage.getItem('recents')||'[]'),rl=document.getElementById('recentList');rl.innerHTML='';r.forEach(x=>{let d=document.createElement('div');d.className='recent-item';d.innerHTML=`<span>${x}</span><button class='delete-btn' onclick='deleteRecent("${x}")'>‚úñÔ∏è</button>`;d.onclick=()=>{document.getElementById('keyword').value=x;searchPlaces();};rl.appendChild(d);} );if(r.length)rl.style.display='block';}
function hideRecent(){setTimeout(()=>document.getElementById('recentList').style.display='none',200);}
function deleteRecent(x){let r=JSON.parse(localStorage.getItem('recents')||'[]');r=r.filter(i=>i!==x);localStorage.setItem('recents',JSON.stringify(r));showRecent();}
</script>
</body>
</html>
